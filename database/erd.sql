-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.account_groups
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    parent_id integer,
    account_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    is_active boolean,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    CONSTRAINT account_groups_pkey PRIMARY KEY (id),
    CONSTRAINT uq_account_group_code_tenant UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.account_masters
(
    id serial NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    code character varying(50) COLLATE pg_catalog."default" NOT NULL,
    account_group_id integer NOT NULL,
    opening_balance numeric(15, 2),
    current_balance numeric(15, 2),
    is_active boolean,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT account_masters_pkey PRIMARY KEY (id),
    CONSTRAINT uq_account_master_code_tenant UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.account_type_mappings
(
    id serial NOT NULL,
    account_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    account_id integer NOT NULL,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT account_type_mappings_pkey PRIMARY KEY (id),
    CONSTRAINT account_type_mappings_account_type_tenant_id_key UNIQUE (account_type, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.accounts
(
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default",
    account_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    balance numeric(15, 2),
    id serial NOT NULL,
    created_at timestamp without time zone,
    created_by text COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by text COLLATE pg_catalog."default",
    is_active boolean,
    is_deleted boolean,
    tenant_id integer,
    CONSTRAINT accounts_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.agencies
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    modified_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    modified_by character varying(100) COLLATE pg_catalog."default",
    is_delete boolean DEFAULT false,
    address text COLLATE pg_catalog."default",
    tax_id character varying(50) COLLATE pg_catalog."default",
    CONSTRAINT agencies_pkey PRIMARY KEY (id),
    CONSTRAINT unique_agency_phone_per_tenant UNIQUE (tenant_id, phone)
);

CREATE TABLE IF NOT EXISTS public.agency_commissions
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    agency_id integer NOT NULL,
    commission_type text COLLATE pg_catalog."default",
    commission_value numeric(10, 2),
    effective_from timestamp without time zone,
    effective_to timestamp without time zone,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    product_type text COLLATE pg_catalog."default" NOT NULL DEFAULT 'Tests'::text,
    product_id integer NOT NULL DEFAULT 0,
    product_name text COLLATE pg_catalog."default" NOT NULL DEFAULT ''::text,
    notes text COLLATE pg_catalog."default",
    product_rate numeric(10, 2),
    CONSTRAINT agency_commissions_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.appointments
(
    id serial NOT NULL,
    appointment_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    patient_id integer NOT NULL,
    doctor_id integer NOT NULL,
    appointment_date date NOT NULL,
    appointment_time time without time zone NOT NULL,
    duration_minutes integer,
    status character varying(20) COLLATE pg_catalog."default",
    reason text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    agency_id integer,
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT appointments_pkey PRIMARY KEY (id),
    CONSTRAINT appointments_appointment_number_key UNIQUE (appointment_number)
);

CREATE TABLE IF NOT EXISTS public.approval_history
(
    id serial NOT NULL,
    request_id integer NOT NULL,
    level_number integer NOT NULL,
    approver_id integer NOT NULL,
    action character varying(20) COLLATE pg_catalog."default" NOT NULL,
    comments text COLLATE pg_catalog."default",
    action_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    tenant_id integer NOT NULL,
    CONSTRAINT approval_history_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.approval_levels
(
    id serial NOT NULL,
    workflow_id integer NOT NULL,
    level_number integer NOT NULL,
    approver_role_id integer,
    approver_user_id integer,
    is_mandatory boolean DEFAULT true,
    tenant_id integer NOT NULL,
    CONSTRAINT approval_levels_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.approval_requests
(
    id serial NOT NULL,
    workflow_id integer NOT NULL,
    entity_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    entity_id integer NOT NULL,
    entity_number character varying(50) COLLATE pg_catalog."default",
    amount numeric(15, 2),
    current_level integer DEFAULT 1,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'PENDING'::character varying,
    requested_by character varying(100) COLLATE pg_catalog."default",
    requested_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    completed_at timestamp without time zone,
    tenant_id integer NOT NULL,
    CONSTRAINT approval_requests_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.approval_workflows
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    entity_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    min_amount numeric(15, 2) DEFAULT 0,
    max_amount numeric(15, 2),
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT approval_workflows_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.asset_categories
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    depreciation_method character varying(20) COLLATE pg_catalog."default" DEFAULT 'SLM'::character varying,
    depreciation_rate numeric(5, 2) DEFAULT 0,
    useful_life_years integer DEFAULT 5,
    account_id integer,
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT asset_categories_pkey PRIMARY KEY (id),
    CONSTRAINT asset_categories_code_tenant_id_key UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.audit_trail
(
    id serial NOT NULL,
    entity_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    entity_id integer NOT NULL,
    action character varying(20) COLLATE pg_catalog."default" NOT NULL,
    old_value jsonb,
    new_value jsonb,
    user_id integer,
    username character varying(100) COLLATE pg_catalog."default",
    ip_address character varying(50) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    remarks text COLLATE pg_catalog."default",
    CONSTRAINT audit_trail_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.bank_reconciliation_items
(
    id serial NOT NULL,
    reconciliation_id integer NOT NULL,
    ledger_id integer,
    statement_amount numeric(15, 2) NOT NULL,
    statement_date date NOT NULL,
    statement_reference character varying(100) COLLATE pg_catalog."default",
    is_matched boolean DEFAULT false,
    match_type character varying(20) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    CONSTRAINT bank_reconciliation_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.bank_reconciliations
(
    id serial NOT NULL,
    bank_account_id integer NOT NULL,
    statement_date date NOT NULL,
    statement_balance numeric(15, 2) NOT NULL,
    book_balance numeric(15, 2) NOT NULL,
    reconciled_balance numeric(15, 2) DEFAULT 0,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT bank_reconciliations_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.bank_statements
(
    statement_id serial NOT NULL,
    account_id integer,
    trans_date date NOT NULL,
    description text COLLATE pg_catalog."default",
    debit numeric(15, 2) DEFAULT 0,
    credit numeric(15, 2) DEFAULT 0,
    balance numeric(15, 2),
    is_reconciled boolean DEFAULT false,
    voucher_id integer,
    reconciled_at timestamp without time zone,
    tenant_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT bank_statements_pkey PRIMARY KEY (statement_id)
);

CREATE TABLE IF NOT EXISTS public.budgets
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    fiscal_year_id integer NOT NULL,
    account_id integer NOT NULL,
    cost_center_id integer,
    budget_amount numeric(15, 2) NOT NULL,
    actual_amount numeric(15, 2) DEFAULT 0,
    variance numeric(15, 2) DEFAULT 0,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT budgets_pkey PRIMARY KEY (id),
    CONSTRAINT uq_budget UNIQUE (fiscal_year_id, account_id, cost_center_id, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.categories
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    parent_id integer,
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT categories_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.clinic_billing_master
(
    id serial NOT NULL,
    description text COLLATE pg_catalog."default" NOT NULL,
    note text COLLATE pg_catalog."default",
    amount numeric(12, 2) NOT NULL,
    tenant_id integer NOT NULL,
    is_active boolean NOT NULL DEFAULT true,
    is_deleted boolean NOT NULL DEFAULT false,
    created_at timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    hsn_code character varying(20) COLLATE pg_catalog."default",
    gst_percentage numeric(5, 2) NOT NULL DEFAULT 0.00,
    CONSTRAINT clinic_billing_master_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.clinic_employees
(
    id serial NOT NULL,
    employee_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    first_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    last_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    role character varying(50) COLLATE pg_catalog."default" NOT NULL,
    department character varying(100) COLLATE pg_catalog."default",
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    hire_date date,
    salary numeric(10, 2),
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT clinic_employees_pkey PRIMARY KEY (id),
    CONSTRAINT clinic_employees_employee_number_key UNIQUE (employee_number)
);

CREATE TABLE IF NOT EXISTS public.clinic_invoice_items
(
    id serial NOT NULL,
    invoice_id integer NOT NULL,
    item_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    product_id integer,
    description character varying(200) COLLATE pg_catalog."default" NOT NULL,
    quantity numeric(10, 2),
    unit_price numeric(10, 2) NOT NULL,
    total_price numeric(10, 2) NOT NULL,
    CONSTRAINT clinic_invoice_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.clinic_invoices
(
    id serial NOT NULL,
    invoice_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    patient_id integer NOT NULL,
    invoice_date timestamp without time zone,
    consultation_fee numeric(10, 2),
    discount_amount numeric(10, 2),
    total_amount numeric(10, 2) NOT NULL,
    payment_status character varying(20) COLLATE pg_catalog."default",
    payment_method character varying(20) COLLATE pg_catalog."default",
    insurance_provider character varying(100) COLLATE pg_catalog."default",
    insurance_claim_number character varying(50) COLLATE pg_catalog."default",
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    appointment_id integer,
    discount_percentage numeric(5, 2) DEFAULT 0,
    final_amount numeric(10, 2) DEFAULT 0,
    CONSTRAINT clinic_invoices_pkey PRIMARY KEY (id),
    CONSTRAINT clinic_invoices_invoice_number_key UNIQUE (invoice_number)
);

CREATE TABLE IF NOT EXISTS public.cost_centers
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    parent_id integer,
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT cost_centers_pkey PRIMARY KEY (id),
    CONSTRAINT uq_cost_center_code_tenant UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.credit_note_items
(
    id serial NOT NULL,
    credit_note_id integer NOT NULL,
    product_id integer,
    description text COLLATE pg_catalog."default",
    quantity numeric(15, 3) NOT NULL,
    rate numeric(15, 2) NOT NULL,
    tax_rate numeric(5, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    amount numeric(15, 2) NOT NULL,
    tenant_id integer NOT NULL,
    CONSTRAINT credit_note_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.credit_notes
(
    id serial NOT NULL,
    note_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    note_date date NOT NULL,
    customer_id integer,
    original_invoice_id integer,
    original_invoice_number character varying(50) COLLATE pg_catalog."default",
    reason text COLLATE pg_catalog."default",
    subtotal numeric(15, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_by character varying(100) COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    is_deleted boolean DEFAULT false,
    CONSTRAINT credit_notes_pkey PRIMARY KEY (id),
    CONSTRAINT credit_notes_note_number_tenant_id_key UNIQUE (note_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.currencies
(
    id serial NOT NULL,
    code character varying(3) COLLATE pg_catalog."default" NOT NULL,
    name character varying(50) COLLATE pg_catalog."default" NOT NULL,
    symbol character varying(5) COLLATE pg_catalog."default",
    is_base boolean DEFAULT false,
    is_active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT currencies_pkey PRIMARY KEY (id),
    CONSTRAINT currencies_code_key UNIQUE (code)
);

CREATE TABLE IF NOT EXISTS public.custom_reports
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    report_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    query_template text COLLATE pg_catalog."default" NOT NULL,
    parameters jsonb,
    is_public boolean DEFAULT false,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT custom_reports_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.customers
(
    id serial NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    age integer,
    address text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    tax_id character varying(100) COLLATE pg_catalog."default",
    credit_limit numeric(15, 2) DEFAULT 0,
    payment_term_id integer,
    credit_hold boolean DEFAULT false,
    outstanding_balance numeric(15, 2) DEFAULT 0,
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT customers_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.dashboard_widgets
(
    id serial NOT NULL,
    user_id integer NOT NULL,
    widget_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    widget_config jsonb,
    position_x integer DEFAULT 0,
    position_y integer DEFAULT 0,
    width integer DEFAULT 4,
    height integer DEFAULT 3,
    is_visible boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT dashboard_widgets_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.debit_note_items
(
    id serial NOT NULL,
    debit_note_id integer NOT NULL,
    product_id integer,
    description text COLLATE pg_catalog."default",
    quantity numeric(15, 3) NOT NULL,
    rate numeric(15, 2) NOT NULL,
    tax_rate numeric(5, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    amount numeric(15, 2) NOT NULL,
    tenant_id integer NOT NULL,
    CONSTRAINT debit_note_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.debit_notes
(
    id serial NOT NULL,
    note_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    note_date date NOT NULL,
    supplier_id integer,
    original_invoice_id integer,
    original_invoice_number character varying(50) COLLATE pg_catalog."default",
    reason text COLLATE pg_catalog."default",
    subtotal numeric(15, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_by character varying(100) COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    is_deleted boolean DEFAULT false,
    CONSTRAINT debit_notes_pkey PRIMARY KEY (id),
    CONSTRAINT debit_notes_note_number_tenant_id_key UNIQUE (note_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.depreciation_schedule
(
    id serial NOT NULL,
    asset_id integer NOT NULL,
    period_date date NOT NULL,
    opening_value numeric(15, 2) NOT NULL,
    depreciation_amount numeric(15, 2) NOT NULL,
    closing_value numeric(15, 2) NOT NULL,
    is_posted boolean DEFAULT false,
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT depreciation_schedule_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.doctors
(
    id serial NOT NULL,
    employee_id character varying(50) COLLATE pg_catalog."default" NOT NULL,
    first_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    last_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    specialization character varying(100) COLLATE pg_catalog."default",
    license_number character varying(50) COLLATE pg_catalog."default",
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    schedule_start time without time zone,
    schedule_end time without time zone,
    consultation_fee numeric(10, 2),
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT doctors_pkey PRIMARY KEY (id),
    CONSTRAINT doctors_employee_id_key UNIQUE (employee_id)
);

CREATE TABLE IF NOT EXISTS public.document_attachments
(
    id serial NOT NULL,
    entity_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    entity_id integer NOT NULL,
    file_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    file_path character varying(500) COLLATE pg_catalog."default" NOT NULL,
    file_size integer,
    file_type character varying(50) COLLATE pg_catalog."default",
    version integer DEFAULT 1,
    is_active boolean DEFAULT true,
    uploaded_by character varying(100) COLLATE pg_catalog."default",
    uploaded_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    tenant_id integer NOT NULL,
    CONSTRAINT document_attachments_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.document_templates
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    template_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    template_content text COLLATE pg_catalog."default" NOT NULL,
    is_default boolean DEFAULT false,
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT document_templates_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.eway_bills
(
    id serial NOT NULL,
    eway_bill_no character varying(50) COLLATE pg_catalog."default" NOT NULL,
    invoice_id integer NOT NULL,
    invoice_type character varying(20) COLLATE pg_catalog."default",
    generated_date timestamp without time zone NOT NULL,
    valid_upto timestamp without time zone,
    vehicle_number character varying(20) COLLATE pg_catalog."default",
    transporter_id character varying(15) COLLATE pg_catalog."default",
    distance integer,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'ACTIVE'::character varying,
    tenant_id integer NOT NULL,
    CONSTRAINT eway_bills_pkey PRIMARY KEY (id),
    CONSTRAINT eway_bills_eway_bill_no_tenant_id_key UNIQUE (eway_bill_no, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.exchange_rates
(
    id serial NOT NULL,
    from_currency_id integer NOT NULL,
    to_currency_id integer NOT NULL,
    rate numeric(15, 6) NOT NULL,
    effective_date date NOT NULL,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT exchange_rates_pkey PRIMARY KEY (id),
    CONSTRAINT uq_exchange_rate UNIQUE (from_currency_id, to_currency_id, effective_date, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.financial_years
(
    name character varying(50) COLLATE pg_catalog."default" NOT NULL,
    start_date timestamp without time zone,
    end_date timestamp without time zone,
    tenant_id integer NOT NULL,
    is_closed boolean,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    id serial NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    CONSTRAINT financial_years_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.fiscal_years
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    start_date date NOT NULL,
    end_date date NOT NULL,
    is_active boolean DEFAULT false,
    is_closed boolean DEFAULT false,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT fiscal_years_pkey PRIMARY KEY (id),
    CONSTRAINT fiscal_years_tenant_id_name_key UNIQUE (tenant_id, name)
);

CREATE TABLE IF NOT EXISTS public.fixed_assets
(
    id serial NOT NULL,
    asset_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    category_id integer NOT NULL,
    purchase_date date NOT NULL,
    purchase_cost numeric(15, 2) NOT NULL,
    salvage_value numeric(15, 2) DEFAULT 0,
    useful_life_years integer NOT NULL,
    depreciation_method character varying(20) COLLATE pg_catalog."default" DEFAULT 'SLM'::character varying,
    depreciation_rate numeric(5, 2),
    accumulated_depreciation numeric(15, 2) DEFAULT 0,
    book_value numeric(15, 2),
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'ACTIVE'::character varying,
    location character varying(200) COLLATE pg_catalog."default",
    serial_number character varying(100) COLLATE pg_catalog."default",
    supplier_id integer,
    purchase_invoice_id integer,
    disposal_date date,
    disposal_value numeric(15, 2),
    disposal_notes text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT fixed_assets_pkey PRIMARY KEY (id),
    CONSTRAINT fixed_assets_asset_number_tenant_id_key UNIQUE (asset_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.gst_configuration
(
    id serial NOT NULL,
    gstin character varying(15) COLLATE pg_catalog."default" NOT NULL,
    legal_name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    trade_name character varying(200) COLLATE pg_catalog."default",
    state_code character varying(2) COLLATE pg_catalog."default" NOT NULL,
    is_composition boolean DEFAULT false,
    einvoice_enabled boolean DEFAULT false,
    einvoice_username character varying(100) COLLATE pg_catalog."default",
    einvoice_password character varying(255) COLLATE pg_catalog."default",
    api_endpoint character varying(255) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT gst_configuration_pkey PRIMARY KEY (id),
    CONSTRAINT gst_configuration_tenant_id_key UNIQUE (tenant_id)
);

CREATE TABLE IF NOT EXISTS public.gstr1_data
(
    id serial NOT NULL,
    return_period character varying(7) COLLATE pg_catalog."default" NOT NULL,
    invoice_id integer NOT NULL,
    invoice_type character varying(20) COLLATE pg_catalog."default",
    gstin character varying(15) COLLATE pg_catalog."default",
    taxable_value numeric(15, 2),
    cgst_amount numeric(15, 2),
    sgst_amount numeric(15, 2),
    igst_amount numeric(15, 2),
    cess_amount numeric(15, 2),
    is_filed boolean DEFAULT false,
    filed_date timestamp without time zone,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT gstr1_data_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.integrations
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    integration_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    provider character varying(50) COLLATE pg_catalog."default" NOT NULL,
    api_key character varying(255) COLLATE pg_catalog."default",
    api_secret character varying(255) COLLATE pg_catalog."default",
    webhook_url character varying(255) COLLATE pg_catalog."default",
    config text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT integrations_pkey PRIMARY KEY (id),
    CONSTRAINT uq_integration UNIQUE (integration_type, provider, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.inventory
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    quantity numeric(10, 2) NOT NULL,
    reserved_quantity numeric(10, 2),
    updated_at timestamp without time zone,
    CONSTRAINT inventory_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.journal_details
(
    id serial NOT NULL,
    journal_id integer NOT NULL,
    account_id integer NOT NULL,
    debit_amount numeric(15, 2),
    credit_amount numeric(15, 2),
    narration text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    tax_id integer,
    taxable_amount numeric(15, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    cost_center_id integer,
    CONSTRAINT journal_details_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.journals
(
    id serial NOT NULL,
    voucher_id integer NOT NULL,
    journal_date timestamp without time zone NOT NULL,
    total_debit numeric(15, 2) NOT NULL,
    total_credit numeric(15, 2) NOT NULL,
    is_balanced boolean,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    CONSTRAINT journals_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.ledgers
(
    id serial NOT NULL,
    account_id integer NOT NULL,
    voucher_id integer NOT NULL,
    transaction_date timestamp without time zone NOT NULL,
    debit_amount numeric(15, 2),
    credit_amount numeric(15, 2),
    balance numeric(15, 2),
    narration text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    CONSTRAINT ledgers_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.legal_entities
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    registration_number character varying(50) COLLATE pg_catalog."default",
    address text COLLATE pg_catalog."default",
    logo character varying(255) COLLATE pg_catalog."default",
    admin_user_id integer,
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT legal_entities_pkey PRIMARY KEY (id),
    CONSTRAINT legal_entities_registration_number_key UNIQUE (registration_number),
    CONSTRAINT uq_legal_entity_code_tenant UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.medical_records
(
    id serial NOT NULL,
    record_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    appointment_id integer,
    visit_date timestamp without time zone,
    chief_complaint text COLLATE pg_catalog."default",
    diagnosis text COLLATE pg_catalog."default",
    treatment_plan text COLLATE pg_catalog."default",
    vital_signs text COLLATE pg_catalog."default",
    lab_results text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    CONSTRAINT medical_records_pkey PRIMARY KEY (id),
    CONSTRAINT medical_records_record_number_key UNIQUE (record_number)
);

CREATE TABLE IF NOT EXISTS public.menu_master
(
    id serial NOT NULL,
    menu_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    menu_code character varying(50) COLLATE pg_catalog."default" NOT NULL,
    module_code character varying(50) COLLATE pg_catalog."default" NOT NULL,
    parent_menu_id integer,
    icon character varying(100) COLLATE pg_catalog."default",
    route character varying(200) COLLATE pg_catalog."default",
    sort_order integer,
    is_admin_only boolean,
    is_active boolean DEFAULT true,
    created_at timestamp without time zone,
    CONSTRAINT menu_master_pkey PRIMARY KEY (id),
    CONSTRAINT menu_master_menu_code_key UNIQUE (menu_code)
);

CREATE TABLE IF NOT EXISTS public.module_master
(
    id serial NOT NULL,
    module_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    module_code character varying(50) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    is_mandatory boolean,
    is_active boolean,
    created_at timestamp without time zone,
    CONSTRAINT module_master_pkey PRIMARY KEY (id),
    CONSTRAINT module_master_module_code_key UNIQUE (module_code),
    CONSTRAINT module_master_module_name_key UNIQUE (module_name)
);

CREATE TABLE IF NOT EXISTS public.notification_logs
(
    log_id serial NOT NULL,
    tenant_id integer,
    notification_type character varying(20) COLLATE pg_catalog."default",
    recipient character varying(255) COLLATE pg_catalog."default",
    subject text COLLATE pg_catalog."default",
    status character varying(20) COLLATE pg_catalog."default",
    error_message text COLLATE pg_catalog."default",
    sent_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT notification_logs_pkey PRIMARY KEY (log_id)
);

CREATE TABLE IF NOT EXISTS public.order_commission_items
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    order_commission_id integer NOT NULL,
    item_type text COLLATE pg_catalog."default" NOT NULL,
    item_id integer NOT NULL,
    item_name text COLLATE pg_catalog."default",
    item_rate numeric(15, 2) DEFAULT 0,
    commission_percentage numeric(5, 2) DEFAULT 0,
    commission_value numeric(15, 2) DEFAULT 0,
    gst_percentage numeric(5, 2) DEFAULT 0,
    gst_amount numeric(15, 2) DEFAULT 0,
    cess_percentage numeric(5, 2) DEFAULT 0,
    cess_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) DEFAULT 0,
    discount_percentage numeric(5, 2) DEFAULT 0,
    discount_amount numeric(15, 2) DEFAULT 0,
    roundoff numeric(15, 2) DEFAULT 0,
    final_amount numeric(15, 2) DEFAULT 0,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT order_commission_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.order_commissions
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    order_type text COLLATE pg_catalog."default" NOT NULL,
    order_id integer NOT NULL,
    order_number text COLLATE pg_catalog."default" NOT NULL,
    agency_id integer,
    agency_name text COLLATE pg_catalog."default",
    agency_phone text COLLATE pg_catalog."default",
    total_amount numeric(15, 2) DEFAULT 0,
    disc_percentage numeric(5, 2) DEFAULT 0,
    disc_amount numeric(15, 2) DEFAULT 0,
    roundoff numeric(15, 2) DEFAULT 0,
    final_amount numeric(15, 2) DEFAULT 0,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    notes text COLLATE pg_catalog."default",
    order_commission_number character varying(50) COLLATE pg_catalog."default",
    CONSTRAINT order_commissions_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.patients
(
    id serial NOT NULL,
    patient_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    first_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    last_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    date_of_birth date,
    gender character varying(10) COLLATE pg_catalog."default",
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    address text COLLATE pg_catalog."default",
    emergency_contact character varying(100) COLLATE pg_catalog."default",
    emergency_phone character varying(20) COLLATE pg_catalog."default",
    blood_group character varying(5) COLLATE pg_catalog."default",
    allergies text COLLATE pg_catalog."default",
    medical_history text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT patients_pkey PRIMARY KEY (id),
    CONSTRAINT patients_patient_number_key UNIQUE (patient_number)
);

CREATE TABLE IF NOT EXISTS public.payment_terms
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    days integer NOT NULL,
    description text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT payment_terms_pkey PRIMARY KEY (id),
    CONSTRAINT payment_terms_code_tenant_id_key UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.payments
(
    id serial NOT NULL,
    payment_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    payment_date timestamp without time zone NOT NULL,
    payment_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    payment_mode character varying(20) COLLATE pg_catalog."default" NOT NULL,
    reference_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    reference_id integer NOT NULL,
    reference_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    amount numeric(15, 2) NOT NULL,
    account_id integer,
    voucher_id integer,
    remarks text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT payments_pkey PRIMARY KEY (id),
    CONSTRAINT payments_payment_number_key UNIQUE (payment_number)
);

CREATE TABLE IF NOT EXISTS public.prescription_items
(
    id serial NOT NULL,
    prescription_id integer NOT NULL,
    product_id integer NOT NULL,
    dosage character varying(100) COLLATE pg_catalog."default",
    frequency character varying(100) COLLATE pg_catalog."default",
    duration character varying(100) COLLATE pg_catalog."default",
    quantity numeric(10, 2),
    instructions text COLLATE pg_catalog."default",
    product_name character varying(200) COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT prescription_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.prescription_test_items
(
    id serial NOT NULL,
    prescription_id integer NOT NULL,
    tenant_id integer NOT NULL,
    test_id integer NOT NULL,
    test_name character varying(200) COLLATE pg_catalog."default",
    instructions text COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT prescription_test_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.prescriptions
(
    id serial NOT NULL,
    prescription_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    patient_id integer NOT NULL,
    doctor_id integer NOT NULL,
    prescription_date timestamp without time zone,
    instructions text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    appointment_id integer,
    CONSTRAINT prescriptions_pkey PRIMARY KEY (id),
    CONSTRAINT prescriptions_prescription_number_key UNIQUE (prescription_number)
);

CREATE TABLE IF NOT EXISTS public.product_batches
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    expiry_date timestamp without time zone,
    mrp numeric(10, 2) NOT NULL,
    purchase_rate numeric(10, 2) NOT NULL,
    sale_rate numeric(10, 2) NOT NULL,
    quantity integer NOT NULL,
    supplier_id integer NOT NULL,
    gst_percentage numeric(5, 2),
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT product_batches_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.product_waste
(
    id serial NOT NULL,
    waste_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    quantity numeric(10, 2) NOT NULL,
    unit_cost numeric(10, 2) NOT NULL,
    total_cost numeric(10, 2) NOT NULL,
    reason character varying(500) COLLATE pg_catalog."default" NOT NULL,
    waste_date timestamp without time zone,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT product_waste_pkey PRIMARY KEY (id),
    CONSTRAINT product_waste_waste_number_key UNIQUE (waste_number)
);

CREATE TABLE IF NOT EXISTS public.products
(
    id serial NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    code character varying(50) COLLATE pg_catalog."default",
    composition text COLLATE pg_catalog."default",
    tags text COLLATE pg_catalog."default",
    hsn_code character varying(20) COLLATE pg_catalog."default",
    schedule character varying(10) COLLATE pg_catalog."default",
    manufacturer character varying(200) COLLATE pg_catalog."default",
    is_discontinued boolean,
    category_id integer NOT NULL,
    subcategory_id integer,
    unit_id integer NOT NULL,
    price numeric(10, 2) NOT NULL,
    gst_percentage numeric(5, 2),
    reorder_level numeric(10, 2),
    danger_level numeric(10, 2),
    min_stock numeric(10, 2),
    max_stock numeric(10, 2),
    description text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    commission_type text COLLATE pg_catalog."default",
    commission_value numeric(10, 2),
    is_inventory_item boolean DEFAULT true,
    barcode character varying(100) COLLATE pg_catalog."default",
    is_serialized boolean DEFAULT false,
    warranty_months integer DEFAULT 0,
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT products_pkey PRIMARY KEY (id),
    CONSTRAINT products_code_key UNIQUE (code)
);

CREATE TABLE IF NOT EXISTS public.purchase_invoice_items
(
    id serial NOT NULL,
    invoice_id integer NOT NULL,
    product_id integer NOT NULL,
    description text COLLATE pg_catalog."default",
    quantity numeric(15, 3) NOT NULL,
    unit_price numeric(15, 2) NOT NULL,
    discount_percent numeric(5, 2) DEFAULT 0,
    discount_amount numeric(15, 2) DEFAULT 0,
    taxable_amount numeric(15, 2) NOT NULL,
    cgst_rate numeric(5, 2) DEFAULT 0,
    cgst_amount numeric(15, 2) DEFAULT 0,
    sgst_rate numeric(5, 2) DEFAULT 0,
    sgst_amount numeric(15, 2) DEFAULT 0,
    igst_rate numeric(5, 2) DEFAULT 0,
    igst_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    hsn_code character varying(20) COLLATE pg_catalog."default",
    batch_number character varying(50) COLLATE pg_catalog."default",
    serial_numbers text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    CONSTRAINT purchase_invoice_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.purchase_invoices
(
    id serial NOT NULL,
    invoice_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    invoice_date date NOT NULL,
    supplier_id integer NOT NULL,
    purchase_order_id integer,
    payment_term_id integer,
    due_date date,
    subtotal numeric(15, 2) DEFAULT 0,
    discount_percent numeric(5, 2) DEFAULT 0,
    discount_amount numeric(15, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    paid_amount numeric(15, 2) DEFAULT 0,
    balance_amount numeric(15, 2) DEFAULT 0,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    notes text COLLATE pg_catalog."default",
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT purchase_invoices_pkey PRIMARY KEY (id),
    CONSTRAINT purchase_invoices_invoice_number_tenant_id_key UNIQUE (invoice_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.purchase_order_items
(
    id serial NOT NULL,
    purchase_order_id integer NOT NULL,
    product_id integer NOT NULL,
    quantity numeric(10, 2) NOT NULL,
    unit_price numeric(10, 2) NOT NULL,
    mrp numeric(10, 2) NOT NULL,
    gst_rate numeric(5, 2),
    discount_percent numeric(5, 2),
    discount_amount numeric(10, 2),
    total_amount numeric(10, 2) NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    free_quantity numeric(10, 2) DEFAULT 0,
    cgst_rate numeric(5, 2) DEFAULT 0,
    sgst_rate numeric(5, 2) DEFAULT 0,
    CONSTRAINT purchase_order_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.purchase_orders
(
    id serial NOT NULL,
    po_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    supplier_id integer NOT NULL,
    order_date timestamp without time zone,
    total_amount numeric(10, 2) NOT NULL,
    discount_percent numeric(5, 2),
    discount_amount numeric(10, 2),
    roundoff numeric(10, 2),
    status character varying(20) COLLATE pg_catalog."default",
    reversal_reason text COLLATE pg_catalog."default",
    reversed_at timestamp without time zone,
    reversed_by character varying(100) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    approval_status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    approval_request_id integer,
    CONSTRAINT purchase_orders_pkey PRIMARY KEY (id),
    CONSTRAINT purchase_orders_po_number_key UNIQUE (po_number)
);

CREATE TABLE IF NOT EXISTS public.recurring_vouchers
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    voucher_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    frequency character varying(20) COLLATE pg_catalog."default" NOT NULL,
    start_date date NOT NULL,
    end_date date,
    description text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT recurring_vouchers_pkey PRIMARY KEY (id),
    CONSTRAINT uq_recurring_voucher UNIQUE (name, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.role_menu_mapping
(
    id serial NOT NULL,
    role_id integer NOT NULL,
    menu_id integer NOT NULL,
    can_create boolean,
    can_update boolean,
    can_delete boolean,
    can_import boolean,
    can_export boolean,
    can_print boolean,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT role_menu_mapping_pkey PRIMARY KEY (id),
    CONSTRAINT uq_role_menu_mapping UNIQUE (role_id, menu_id)
);

CREATE TABLE IF NOT EXISTS public.roles
(
    id serial NOT NULL,
    name character varying(50) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT roles_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.sales_invoice_items
(
    id serial NOT NULL,
    invoice_id integer NOT NULL,
    product_id integer NOT NULL,
    description text COLLATE pg_catalog."default",
    quantity numeric(15, 3) NOT NULL,
    unit_price numeric(15, 2) NOT NULL,
    discount_percent numeric(5, 2) DEFAULT 0,
    discount_amount numeric(15, 2) DEFAULT 0,
    taxable_amount numeric(15, 2) NOT NULL,
    cgst_rate numeric(5, 2) DEFAULT 0,
    cgst_amount numeric(15, 2) DEFAULT 0,
    sgst_rate numeric(5, 2) DEFAULT 0,
    sgst_amount numeric(15, 2) DEFAULT 0,
    igst_rate numeric(5, 2) DEFAULT 0,
    igst_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    hsn_code character varying(20) COLLATE pg_catalog."default",
    batch_number character varying(50) COLLATE pg_catalog."default",
    serial_numbers text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    CONSTRAINT sales_invoice_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.sales_invoices
(
    id serial NOT NULL,
    invoice_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    invoice_date date NOT NULL,
    customer_id integer NOT NULL,
    sales_order_id integer,
    payment_term_id integer,
    due_date date,
    subtotal numeric(15, 2) DEFAULT 0,
    discount_percent numeric(5, 2) DEFAULT 0,
    discount_amount numeric(15, 2) DEFAULT 0,
    tax_amount numeric(15, 2) DEFAULT 0,
    total_amount numeric(15, 2) NOT NULL,
    paid_amount numeric(15, 2) DEFAULT 0,
    balance_amount numeric(15, 2) DEFAULT 0,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    invoice_type character varying(20) COLLATE pg_catalog."default" DEFAULT 'TAX_INVOICE'::character varying,
    notes text COLLATE pg_catalog."default",
    terms_conditions text COLLATE pg_catalog."default",
    is_einvoice boolean DEFAULT false,
    einvoice_irn character varying(100) COLLATE pg_catalog."default",
    einvoice_ack_no character varying(50) COLLATE pg_catalog."default",
    einvoice_ack_date timestamp without time zone,
    eway_bill_no character varying(50) COLLATE pg_catalog."default",
    eway_bill_date timestamp without time zone,
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT sales_invoices_pkey PRIMARY KEY (id),
    CONSTRAINT sales_invoices_invoice_number_tenant_id_key UNIQUE (invoice_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.sales_order_items
(
    id serial NOT NULL,
    sales_order_id integer NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    quantity numeric(10, 2) NOT NULL,
    free_quantity numeric(10, 2),
    unit_price numeric(10, 2) NOT NULL,
    gst_rate numeric(5, 2),
    discount_percent numeric(5, 2),
    discount_amount numeric(10, 2),
    total_price numeric(10, 2) NOT NULL,
    cgst_rate numeric(5, 2) DEFAULT 0,
    sgst_rate numeric(5, 2) DEFAULT 0,
    CONSTRAINT sales_order_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.sales_orders
(
    id serial NOT NULL,
    order_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    customer_id integer NOT NULL,
    order_date timestamp without time zone,
    total_amount numeric(10, 2) NOT NULL,
    discount_percent numeric(5, 2),
    discount_amount numeric(10, 2),
    roundoff numeric(10, 2),
    status character varying(20) COLLATE pg_catalog."default",
    reversal_reason text COLLATE pg_catalog."default",
    reversed_at timestamp without time zone,
    reversed_by character varying(100) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    agency_id integer,
    is_deleted boolean DEFAULT false,
    CONSTRAINT sales_orders_pkey PRIMARY KEY (id),
    CONSTRAINT sales_orders_order_number_key UNIQUE (order_number)
);

CREATE TABLE IF NOT EXISTS public.scheduled_reports
(
    id serial NOT NULL,
    report_id integer NOT NULL,
    schedule_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    schedule_time time without time zone,
    schedule_day integer,
    email_recipients text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    last_run timestamp without time zone,
    next_run timestamp without time zone,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT scheduled_reports_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.serial_numbers
(
    id serial NOT NULL,
    serial_number character varying(100) COLLATE pg_catalog."default" NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'IN_STOCK'::character varying,
    purchase_invoice_id integer,
    sales_invoice_id integer,
    warranty_expiry_date date,
    location_id integer,
    notes text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT serial_numbers_pkey PRIMARY KEY (id),
    CONSTRAINT serial_numbers_serial_number_tenant_id_key UNIQUE (serial_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.stock_balances
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    available_quantity numeric(10, 2) DEFAULT 0,
    reserved_quantity numeric(10, 2) DEFAULT 0,
    total_quantity numeric(10, 2) DEFAULT 0,
    average_cost numeric(10, 2) DEFAULT 0,
    last_updated timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    tenant_id integer NOT NULL,
    CONSTRAINT stock_balances_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.stock_by_location
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    warehouse_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    quantity numeric(15, 3) DEFAULT 0,
    reserved_quantity numeric(15, 3) DEFAULT 0,
    available_quantity numeric(15, 3) DEFAULT 0,
    tenant_id integer NOT NULL,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT stock_by_location_pkey PRIMARY KEY (id),
    CONSTRAINT stock_by_location_product_id_warehouse_id_batch_number_tena_key UNIQUE (product_id, warehouse_id, batch_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.stock_meter
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    quantity numeric(10, 2) NOT NULL,
    unit_price numeric(10, 2) NOT NULL,
    location character varying(100) COLLATE pg_catalog."default",
    created_at timestamp without time zone,
    CONSTRAINT stock_meter_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.stock_transactions
(
    id serial NOT NULL,
    product_id integer NOT NULL,
    transaction_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    transaction_source character varying(20) COLLATE pg_catalog."default" NOT NULL,
    reference_id integer NOT NULL,
    reference_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    quantity numeric(10, 2) NOT NULL,
    unit_price numeric(10, 2) NOT NULL,
    transaction_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    expiry_date date,
    manufacturing_date date,
    warehouse_id integer,
    CONSTRAINT stock_transactions_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.stock_transfer_items
(
    id serial NOT NULL,
    transfer_id integer NOT NULL,
    product_id integer NOT NULL,
    batch_number character varying(50) COLLATE pg_catalog."default",
    quantity numeric(15, 3) NOT NULL,
    serial_numbers text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    CONSTRAINT stock_transfer_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.stock_transfers
(
    id serial NOT NULL,
    transfer_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    transfer_date date NOT NULL,
    from_warehouse_id integer NOT NULL,
    to_warehouse_id integer NOT NULL,
    status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    notes text COLLATE pg_catalog."default",
    voucher_id integer,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    approved_at timestamp without time zone,
    approved_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT stock_transfers_pkey PRIMARY KEY (id),
    CONSTRAINT stock_transfers_transfer_number_tenant_id_key UNIQUE (transfer_number, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.subcategories
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    category_id integer NOT NULL,
    description text COLLATE pg_catalog."default",
    is_active boolean,
    created_at timestamp without time zone,
    CONSTRAINT subcategories_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.suppliers
(
    id serial NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    phone character varying(20) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default",
    tax_id character varying(50) COLLATE pg_catalog."default",
    address text COLLATE pg_catalog."default",
    contact_person character varying(100) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_active boolean,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT suppliers_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.tax_masters
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    tax_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    rate numeric(5, 2) NOT NULL,
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT tax_masters_pkey PRIMARY KEY (id),
    CONSTRAINT uq_tax_master_name_tenant UNIQUE (name, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.tds_deductions
(
    id serial NOT NULL,
    payment_id integer NOT NULL,
    section character varying(20) COLLATE pg_catalog."default" NOT NULL,
    gross_amount numeric(15, 2) NOT NULL,
    tds_rate numeric(5, 2) NOT NULL,
    tds_amount numeric(15, 2) NOT NULL,
    net_amount numeric(15, 2) NOT NULL,
    deduction_date date NOT NULL,
    challan_number character varying(50) COLLATE pg_catalog."default",
    challan_date date,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT tds_deductions_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.tds_rates
(
    id serial NOT NULL,
    section character varying(20) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    rate numeric(5, 2) NOT NULL,
    threshold_limit numeric(15, 2),
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT tds_rates_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.tds_sections
(
    id serial NOT NULL,
    section_code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default" NOT NULL,
    rate numeric(5, 2) NOT NULL,
    threshold_limit numeric(15, 2) DEFAULT 0,
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone,
    CONSTRAINT tds_sections_pkey PRIMARY KEY (id),
    CONSTRAINT tds_sections_section_code_tenant_id_key UNIQUE (section_code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.tenant_module_mapping
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    module_id integer NOT NULL,
    is_active boolean DEFAULT true,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT tenant_module_mapping_pkey PRIMARY KEY (id),
    CONSTRAINT uq_tenant_module_mapping UNIQUE (tenant_id, module_id)
);

CREATE TABLE IF NOT EXISTS public.tenant_settings
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    setting text COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    value_type text COLLATE pg_catalog."default" DEFAULT 'BOOLEAN'::text,
    value text COLLATE pg_catalog."default" DEFAULT 'TRUE'::text,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by text COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by text COLLATE pg_catalog."default",
    CONSTRAINT tenant_settings_pkey PRIMARY KEY (id),
    CONSTRAINT tenant_settings_tenant_id_setting_key UNIQUE (tenant_id, setting)
);

CREATE TABLE IF NOT EXISTS public.tenants
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    logo character varying(255) COLLATE pg_catalog."default",
    tagline character varying(255) COLLATE pg_catalog."default",
    address text COLLATE pg_catalog."default",
    is_active boolean,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    business_type text COLLATE pg_catalog."default" DEFAULT 'TRADING'::text,
    CONSTRAINT tenants_pkey PRIMARY KEY (id),
    CONSTRAINT tenants_code_key UNIQUE (code)
);

CREATE TABLE IF NOT EXISTS public.test_categories
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_categories_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_order_items
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_order_id integer NOT NULL,
    test_id integer,
    test_name character varying(200) COLLATE pg_catalog."default",
    panel_id integer,
    panel_name character varying(200) COLLATE pg_catalog."default",
    rate numeric(10, 2),
    gst numeric(5, 2),
    cess numeric(5, 2),
    disc_percentage numeric(5, 2),
    disc_amount numeric(10, 2),
    total_amount numeric(10, 2),
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_order_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_orders
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_order_number text COLLATE pg_catalog."default" NOT NULL,
    appointment_id integer,
    patient_name character varying(200) COLLATE pg_catalog."default",
    patient_phone character varying(20) COLLATE pg_catalog."default",
    doctor_name character varying(200) COLLATE pg_catalog."default",
    doctor_phone character varying(20) COLLATE pg_catalog."default",
    doctor_license_number character varying(100) COLLATE pg_catalog."default",
    order_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    status text COLLATE pg_catalog."default",
    urgency text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    agency_id integer,
    total_amount numeric(10, 2),
    disc_percentage numeric(5, 2),
    disc_amount numeric(10, 2),
    roundoff numeric(10, 2),
    final_amount numeric(10, 2),
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_orders_pkey PRIMARY KEY (id),
    CONSTRAINT test_orders_test_order_number_key UNIQUE (test_order_number)
);

CREATE TABLE IF NOT EXISTS public.test_panel_items
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    panel_id integer NOT NULL,
    test_id integer NOT NULL,
    test_name character varying(200) COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_panel_items_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_panels
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    category_id integer,
    cost numeric(10, 2),
    gst numeric(5, 2),
    cess numeric(5, 2),
    expired_on timestamp without time zone,
    is_active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_panels_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_parameters
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_id integer NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    unit character varying(50) COLLATE pg_catalog."default",
    normal_range character varying(100) COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_parameters_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_result_details
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_result_id integer NOT NULL,
    parameter_id text COLLATE pg_catalog."default",
    parameter_name text COLLATE pg_catalog."default",
    parameter_value text COLLATE pg_catalog."default",
    reference_value text COLLATE pg_catalog."default",
    verdict text COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    unit text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    CONSTRAINT test_result_details_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_result_files
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_result_id integer NOT NULL,
    file_name text COLLATE pg_catalog."default",
    file_path text COLLATE pg_catalog."default",
    file_format text COLLATE pg_catalog."default",
    file_size bigint,
    acquisition_date timestamp without time zone,
    description text COLLATE pg_catalog."default",
    storage_system text COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT test_result_files_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.test_results
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    test_order_id integer NOT NULL,
    result_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    overall_report text COLLATE pg_catalog."default",
    performed_by text COLLATE pg_catalog."default",
    result_type text COLLATE pg_catalog."default",
    notes text COLLATE pg_catalog."default",
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    result_number text COLLATE pg_catalog."default",
    doctor_id integer,
    license_number text COLLATE pg_catalog."default",
    CONSTRAINT test_results_pkey PRIMARY KEY (id),
    CONSTRAINT test_results_result_number_key UNIQUE (result_number)
);

CREATE TABLE IF NOT EXISTS public.tests
(
    id serial NOT NULL,
    tenant_id integer NOT NULL,
    name character varying(200) COLLATE pg_catalog."default" NOT NULL,
    category_id integer,
    body_part character varying(100) COLLATE pg_catalog."default",
    description text COLLATE pg_catalog."default",
    typical_duration character varying(50) COLLATE pg_catalog."default",
    preparation_instruction text COLLATE pg_catalog."default",
    rate numeric(10, 2),
    hsn_code character varying(20) COLLATE pg_catalog."default",
    gst numeric(5, 2),
    cess numeric(5, 2),
    is_active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    commission_type text COLLATE pg_catalog."default",
    commission_value numeric(10, 2),
    CONSTRAINT tests_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.transaction_template_rules
(
    id serial NOT NULL,
    template_id integer NOT NULL,
    line_number integer NOT NULL,
    account_id integer,
    account_type character varying(50) COLLATE pg_catalog."default",
    entry_type character varying(10) COLLATE pg_catalog."default" NOT NULL,
    amount_source character varying(50) COLLATE pg_catalog."default" NOT NULL,
    percentage numeric(5, 2),
    narration text COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT transaction_template_rules_pkey PRIMARY KEY (id),
    CONSTRAINT transaction_template_rules_template_id_line_number_key UNIQUE (template_id, line_number)
);

CREATE TABLE IF NOT EXISTS public.transaction_templates
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    transaction_type character varying(50) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT transaction_templates_pkey PRIMARY KEY (id),
    CONSTRAINT transaction_templates_code_tenant_id_key UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.transactions
(
    description character varying(255) COLLATE pg_catalog."default" NOT NULL,
    amount numeric(15, 2) NOT NULL,
    transaction_type character varying(10) COLLATE pg_catalog."default" NOT NULL,
    transaction_date timestamp without time zone NOT NULL,
    account_id integer,
    id serial NOT NULL,
    created_at timestamp without time zone,
    created_by text COLLATE pg_catalog."default",
    updated_at timestamp without time zone,
    updated_by text COLLATE pg_catalog."default",
    is_active boolean,
    is_deleted boolean,
    tenant_id integer,
    CONSTRAINT transactions_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.units
(
    id serial NOT NULL,
    name character varying(50) COLLATE pg_catalog."default" NOT NULL,
    symbol character varying(10) COLLATE pg_catalog."default",
    is_active boolean,
    created_at timestamp without time zone,
    tenant_id integer NOT NULL,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    parent_id integer,
    conversion_factor numeric(10, 4) DEFAULT 1.0,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    is_deleted boolean DEFAULT false,
    CONSTRAINT units_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.user_roles
(
    id serial NOT NULL,
    user_id integer NOT NULL,
    role_id integer NOT NULL,
    tenant_id integer NOT NULL,
    assigned_at timestamp without time zone,
    assigned_by integer,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT user_roles_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    id serial NOT NULL,
    username character varying(50) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default" NOT NULL,
    password_hash character varying(255) COLLATE pg_catalog."default" NOT NULL,
    first_name character varying(50) COLLATE pg_catalog."default",
    last_name character varying(50) COLLATE pg_catalog."default",
    tenant_id integer NOT NULL,
    is_tenant_admin boolean,
    is_active boolean,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    updated_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    CONSTRAINT users_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.voucher_types
(
    id serial NOT NULL,
    name character varying(50) COLLATE pg_catalog."default" NOT NULL,
    code character varying(10) COLLATE pg_catalog."default" NOT NULL,
    prefix character varying(10) COLLATE pg_catalog."default",
    is_active boolean,
    tenant_id integer NOT NULL,
    CONSTRAINT voucher_types_pkey PRIMARY KEY (id),
    CONSTRAINT uq_voucher_type_code_tenant UNIQUE (code, tenant_id)
);

CREATE TABLE IF NOT EXISTS public.vouchers
(
    id serial NOT NULL,
    voucher_number character varying(50) COLLATE pg_catalog."default" NOT NULL,
    voucher_type_id integer NOT NULL,
    voucher_date timestamp without time zone NOT NULL,
    reference_type character varying(20) COLLATE pg_catalog."default",
    reference_id integer,
    reference_number character varying(50) COLLATE pg_catalog."default",
    narration text COLLATE pg_catalog."default",
    total_amount numeric(15, 2) NOT NULL,
    is_posted boolean,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone,
    created_by character varying(100) COLLATE pg_catalog."default",
    is_deleted boolean DEFAULT false,
    currency_id integer,
    exchange_rate numeric(15, 6) DEFAULT 1,
    base_currency_amount numeric(15, 2),
    reversed_voucher_id integer,
    reversal_voucher_id integer,
    is_reversal boolean DEFAULT false,
    approval_status character varying(20) COLLATE pg_catalog."default" DEFAULT 'DRAFT'::character varying,
    approval_request_id integer,
    CONSTRAINT vouchers_pkey PRIMARY KEY (id),
    CONSTRAINT vouchers_voucher_number_key UNIQUE (voucher_number)
);

CREATE TABLE IF NOT EXISTS public.warehouses
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    address text COLLATE pg_catalog."default",
    contact_person character varying(100) COLLATE pg_catalog."default",
    phone character varying(20) COLLATE pg_catalog."default",
    email character varying(100) COLLATE pg_catalog."default",
    is_active boolean DEFAULT true,
    tenant_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    created_by character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT warehouses_pkey PRIMARY KEY (id),
    CONSTRAINT warehouses_code_tenant_id_key UNIQUE (code, tenant_id)
);

ALTER TABLE IF EXISTS public.account_groups
    ADD CONSTRAINT account_groups_parent_id_fkey FOREIGN KEY (parent_id)
    REFERENCES public.account_groups (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.account_groups
    ADD CONSTRAINT account_groups_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_account_groups_tenant
    ON public.account_groups(tenant_id);


ALTER TABLE IF EXISTS public.account_masters
    ADD CONSTRAINT account_masters_account_group_id_fkey FOREIGN KEY (account_group_id)
    REFERENCES public.account_groups (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.account_masters
    ADD CONSTRAINT account_masters_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_account_masters_tenant
    ON public.account_masters(tenant_id);


ALTER TABLE IF EXISTS public.account_type_mappings
    ADD CONSTRAINT account_type_mappings_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.account_type_mappings
    ADD CONSTRAINT account_type_mappings_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.accounts
    ADD CONSTRAINT accounts_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.agencies
    ADD CONSTRAINT agencies_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_agencies_tenant_id
    ON public.agencies(tenant_id);


ALTER TABLE IF EXISTS public.agency_commissions
    ADD CONSTRAINT agency_commissions_agency_id_fkey FOREIGN KEY (agency_id)
    REFERENCES public.agencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_agency_commissions_agency
    ON public.agency_commissions(agency_id);


ALTER TABLE IF EXISTS public.agency_commissions
    ADD CONSTRAINT agency_commissions_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_agency_commissions_tenant
    ON public.agency_commissions(tenant_id);


ALTER TABLE IF EXISTS public.appointments
    ADD CONSTRAINT appointments_agency_id_fkey FOREIGN KEY (agency_id)
    REFERENCES public.agencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_appointments_agency
    ON public.appointments(agency_id);


ALTER TABLE IF EXISTS public.appointments
    ADD CONSTRAINT appointments_doctor_id_fkey FOREIGN KEY (doctor_id)
    REFERENCES public.doctors (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.appointments
    ADD CONSTRAINT appointments_patient_id_fkey FOREIGN KEY (patient_id)
    REFERENCES public.patients (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_appointments_patient
    ON public.appointments(patient_id);


ALTER TABLE IF EXISTS public.appointments
    ADD CONSTRAINT appointments_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_appointments_tenant
    ON public.appointments(tenant_id);


ALTER TABLE IF EXISTS public.approval_history
    ADD CONSTRAINT approval_history_request_id_fkey FOREIGN KEY (request_id)
    REFERENCES public.approval_requests (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.approval_levels
    ADD CONSTRAINT approval_levels_workflow_id_fkey FOREIGN KEY (workflow_id)
    REFERENCES public.approval_workflows (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.audit_trail
    ADD CONSTRAINT audit_trail_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.audit_trail
    ADD CONSTRAINT audit_trail_user_id_fkey FOREIGN KEY (user_id)
    REFERENCES public.users (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.bank_reconciliation_items
    ADD CONSTRAINT bank_reconciliation_items_ledger_id_fkey FOREIGN KEY (ledger_id)
    REFERENCES public.ledgers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.bank_reconciliation_items
    ADD CONSTRAINT bank_reconciliation_items_reconciliation_id_fkey FOREIGN KEY (reconciliation_id)
    REFERENCES public.bank_reconciliations (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.bank_reconciliation_items
    ADD CONSTRAINT bank_reconciliation_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.bank_reconciliations
    ADD CONSTRAINT bank_reconciliations_bank_account_id_fkey FOREIGN KEY (bank_account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.bank_reconciliations
    ADD CONSTRAINT bank_reconciliations_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.budgets
    ADD CONSTRAINT budgets_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.budgets
    ADD CONSTRAINT budgets_cost_center_id_fkey FOREIGN KEY (cost_center_id)
    REFERENCES public.cost_centers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.budgets
    ADD CONSTRAINT budgets_fiscal_year_id_fkey FOREIGN KEY (fiscal_year_id)
    REFERENCES public.fiscal_years (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.budgets
    ADD CONSTRAINT budgets_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.categories
    ADD CONSTRAINT categories_parent_id_fkey FOREIGN KEY (parent_id)
    REFERENCES public.categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.categories
    ADD CONSTRAINT categories_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_categories_tenant_id
    ON public.categories(tenant_id);


ALTER TABLE IF EXISTS public.clinic_billing_master
    ADD CONSTRAINT clinic_billing_master_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_clinic_billing_master_tenant_id
    ON public.clinic_billing_master(tenant_id);


ALTER TABLE IF EXISTS public.clinic_employees
    ADD CONSTRAINT clinic_employees_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_clinic_employees_tenant
    ON public.clinic_employees(tenant_id);


ALTER TABLE IF EXISTS public.clinic_invoice_items
    ADD CONSTRAINT clinic_invoice_items_invoice_id_fkey FOREIGN KEY (invoice_id)
    REFERENCES public.clinic_invoices (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.clinic_invoice_items
    ADD CONSTRAINT clinic_invoice_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.clinic_invoices
    ADD CONSTRAINT clinic_invoices_patient_id_fkey FOREIGN KEY (patient_id)
    REFERENCES public.patients (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_clinic_invoices_patient
    ON public.clinic_invoices(patient_id);


ALTER TABLE IF EXISTS public.clinic_invoices
    ADD CONSTRAINT clinic_invoices_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_clinic_invoices_tenant
    ON public.clinic_invoices(tenant_id);


ALTER TABLE IF EXISTS public.clinic_invoices
    ADD CONSTRAINT clinic_invoices_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.clinic_invoices
    ADD CONSTRAINT fk_clinic_invoices_appointment_id FOREIGN KEY (appointment_id)
    REFERENCES public.appointments (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.cost_centers
    ADD CONSTRAINT cost_centers_parent_id_fkey FOREIGN KEY (parent_id)
    REFERENCES public.cost_centers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.cost_centers
    ADD CONSTRAINT cost_centers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.credit_note_items
    ADD CONSTRAINT credit_note_items_credit_note_id_fkey FOREIGN KEY (credit_note_id)
    REFERENCES public.credit_notes (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.credit_note_items
    ADD CONSTRAINT credit_note_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.credit_note_items
    ADD CONSTRAINT credit_note_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.credit_notes
    ADD CONSTRAINT credit_notes_customer_id_fkey FOREIGN KEY (customer_id)
    REFERENCES public.customers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.credit_notes
    ADD CONSTRAINT credit_notes_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.credit_notes
    ADD CONSTRAINT credit_notes_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.customers
    ADD CONSTRAINT customers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_customers_tenant_id
    ON public.customers(tenant_id);


ALTER TABLE IF EXISTS public.debit_note_items
    ADD CONSTRAINT debit_note_items_debit_note_id_fkey FOREIGN KEY (debit_note_id)
    REFERENCES public.debit_notes (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.debit_note_items
    ADD CONSTRAINT debit_note_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.debit_note_items
    ADD CONSTRAINT debit_note_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.debit_notes
    ADD CONSTRAINT debit_notes_supplier_id_fkey FOREIGN KEY (supplier_id)
    REFERENCES public.suppliers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.debit_notes
    ADD CONSTRAINT debit_notes_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.debit_notes
    ADD CONSTRAINT debit_notes_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.depreciation_schedule
    ADD CONSTRAINT depreciation_schedule_asset_id_fkey FOREIGN KEY (asset_id)
    REFERENCES public.fixed_assets (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.doctors
    ADD CONSTRAINT doctors_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_doctors_tenant
    ON public.doctors(tenant_id);


ALTER TABLE IF EXISTS public.exchange_rates
    ADD CONSTRAINT exchange_rates_from_currency_id_fkey FOREIGN KEY (from_currency_id)
    REFERENCES public.currencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.exchange_rates
    ADD CONSTRAINT exchange_rates_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.exchange_rates
    ADD CONSTRAINT exchange_rates_to_currency_id_fkey FOREIGN KEY (to_currency_id)
    REFERENCES public.currencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.integrations
    ADD CONSTRAINT integrations_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.inventory
    ADD CONSTRAINT inventory_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journal_details
    ADD CONSTRAINT journal_details_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journal_details
    ADD CONSTRAINT journal_details_cost_center_id_fkey FOREIGN KEY (cost_center_id)
    REFERENCES public.cost_centers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journal_details
    ADD CONSTRAINT journal_details_journal_id_fkey FOREIGN KEY (journal_id)
    REFERENCES public.journals (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journal_details
    ADD CONSTRAINT journal_details_tax_id_fkey FOREIGN KEY (tax_id)
    REFERENCES public.tax_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journal_details
    ADD CONSTRAINT journal_details_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.journals
    ADD CONSTRAINT journals_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_journals_tenant
    ON public.journals(tenant_id);


ALTER TABLE IF EXISTS public.journals
    ADD CONSTRAINT journals_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.ledgers
    ADD CONSTRAINT ledgers_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_ledgers_account
    ON public.ledgers(account_id);


ALTER TABLE IF EXISTS public.ledgers
    ADD CONSTRAINT ledgers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_ledgers_tenant
    ON public.ledgers(tenant_id);


ALTER TABLE IF EXISTS public.ledgers
    ADD CONSTRAINT ledgers_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.legal_entities
    ADD CONSTRAINT legal_entities_admin_user_id_fkey FOREIGN KEY (admin_user_id)
    REFERENCES public.users (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.legal_entities
    ADD CONSTRAINT legal_entities_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.medical_records
    ADD CONSTRAINT medical_records_appointment_id_fkey FOREIGN KEY (appointment_id)
    REFERENCES public.appointments (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.medical_records
    ADD CONSTRAINT medical_records_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_medical_records_tenant
    ON public.medical_records(tenant_id);


ALTER TABLE IF EXISTS public.menu_master
    ADD CONSTRAINT menu_master_parent_menu_id_fkey FOREIGN KEY (parent_menu_id)
    REFERENCES public.menu_master (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.order_commission_items
    ADD CONSTRAINT order_commission_items_order_commission_id_fkey FOREIGN KEY (order_commission_id)
    REFERENCES public.order_commissions (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_order_commission_items_order_commission_id
    ON public.order_commission_items(order_commission_id);


ALTER TABLE IF EXISTS public.order_commission_items
    ADD CONSTRAINT order_commission_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_order_commission_items_tenant_id
    ON public.order_commission_items(tenant_id);


ALTER TABLE IF EXISTS public.order_commissions
    ADD CONSTRAINT order_commissions_agency_id_fkey FOREIGN KEY (agency_id)
    REFERENCES public.agencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_order_commissions_agency_id
    ON public.order_commissions(agency_id);


ALTER TABLE IF EXISTS public.order_commissions
    ADD CONSTRAINT order_commissions_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_order_commissions_tenant_id
    ON public.order_commissions(tenant_id);


ALTER TABLE IF EXISTS public.patients
    ADD CONSTRAINT patients_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_patients_tenant
    ON public.patients(tenant_id);


ALTER TABLE IF EXISTS public.payments
    ADD CONSTRAINT payments_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.payments
    ADD CONSTRAINT payments_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.payments
    ADD CONSTRAINT payments_voucher_id_fkey FOREIGN KEY (voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescription_items
    ADD CONSTRAINT prescription_items_prescription_id_fkey FOREIGN KEY (prescription_id)
    REFERENCES public.prescriptions (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescription_items
    ADD CONSTRAINT prescription_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescription_test_items
    ADD CONSTRAINT prescription_test_items_prescription_id_fkey FOREIGN KEY (prescription_id)
    REFERENCES public.prescriptions (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescription_test_items
    ADD CONSTRAINT prescription_test_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescription_test_items
    ADD CONSTRAINT prescription_test_items_test_id_fkey FOREIGN KEY (test_id)
    REFERENCES public.tests (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescriptions
    ADD CONSTRAINT prescriptions_appointment_id_fkey FOREIGN KEY (appointment_id)
    REFERENCES public.appointments (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescriptions
    ADD CONSTRAINT prescriptions_doctor_id_fkey FOREIGN KEY (doctor_id)
    REFERENCES public.doctors (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.prescriptions
    ADD CONSTRAINT prescriptions_patient_id_fkey FOREIGN KEY (patient_id)
    REFERENCES public.patients (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_prescriptions_patient
    ON public.prescriptions(patient_id);


ALTER TABLE IF EXISTS public.prescriptions
    ADD CONSTRAINT prescriptions_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_prescriptions_tenant
    ON public.prescriptions(tenant_id);


ALTER TABLE IF EXISTS public.product_batches
    ADD CONSTRAINT product_batches_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product_batches
    ADD CONSTRAINT product_batches_supplier_id_fkey FOREIGN KEY (supplier_id)
    REFERENCES public.suppliers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product_batches
    ADD CONSTRAINT product_batches_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product_waste
    ADD CONSTRAINT product_waste_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product_waste
    ADD CONSTRAINT product_waste_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT products_category_id_fkey FOREIGN KEY (category_id)
    REFERENCES public.categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_products_category_id
    ON public.products(category_id);


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT products_subcategory_id_fkey FOREIGN KEY (subcategory_id)
    REFERENCES public.subcategories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT products_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_products_tenant_id
    ON public.products(tenant_id);


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT products_unit_id_fkey FOREIGN KEY (unit_id)
    REFERENCES public.units (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.purchase_invoice_items
    ADD CONSTRAINT purchase_invoice_items_invoice_id_fkey FOREIGN KEY (invoice_id)
    REFERENCES public.purchase_invoices (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.purchase_order_items
    ADD CONSTRAINT purchase_order_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.purchase_order_items
    ADD CONSTRAINT purchase_order_items_purchase_order_id_fkey FOREIGN KEY (purchase_order_id)
    REFERENCES public.purchase_orders (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.purchase_orders
    ADD CONSTRAINT purchase_orders_supplier_id_fkey FOREIGN KEY (supplier_id)
    REFERENCES public.suppliers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.purchase_orders
    ADD CONSTRAINT purchase_orders_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.recurring_vouchers
    ADD CONSTRAINT recurring_vouchers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.role_menu_mapping
    ADD CONSTRAINT role_menu_mapping_menu_id_fkey FOREIGN KEY (menu_id)
    REFERENCES public.menu_master (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.role_menu_mapping
    ADD CONSTRAINT role_menu_mapping_role_id_fkey FOREIGN KEY (role_id)
    REFERENCES public.roles (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.role_menu_mapping
    ADD CONSTRAINT role_menu_mapping_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.roles
    ADD CONSTRAINT roles_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_roles_tenant_id
    ON public.roles(tenant_id);


ALTER TABLE IF EXISTS public.sales_invoice_items
    ADD CONSTRAINT sales_invoice_items_invoice_id_fkey FOREIGN KEY (invoice_id)
    REFERENCES public.sales_invoices (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.sales_order_items
    ADD CONSTRAINT sales_order_items_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.sales_order_items
    ADD CONSTRAINT sales_order_items_sales_order_id_fkey FOREIGN KEY (sales_order_id)
    REFERENCES public.sales_orders (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.sales_orders
    ADD CONSTRAINT sales_orders_agency_id_fkey FOREIGN KEY (agency_id)
    REFERENCES public.agencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_sales_orders_agency
    ON public.sales_orders(agency_id);


ALTER TABLE IF EXISTS public.sales_orders
    ADD CONSTRAINT sales_orders_customer_id_fkey FOREIGN KEY (customer_id)
    REFERENCES public.customers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.sales_orders
    ADD CONSTRAINT sales_orders_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.stock_balances
    ADD CONSTRAINT stock_balances_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_stock_balances_product
    ON public.stock_balances(product_id);


ALTER TABLE IF EXISTS public.stock_meter
    ADD CONSTRAINT stock_meter_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.stock_transactions
    ADD CONSTRAINT stock_transactions_product_id_fkey FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_stock_transactions_product
    ON public.stock_transactions(product_id);


ALTER TABLE IF EXISTS public.stock_transfer_items
    ADD CONSTRAINT stock_transfer_items_transfer_id_fkey FOREIGN KEY (transfer_id)
    REFERENCES public.stock_transfers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.subcategories
    ADD CONSTRAINT subcategories_category_id_fkey FOREIGN KEY (category_id)
    REFERENCES public.categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.suppliers
    ADD CONSTRAINT suppliers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_suppliers_tenant_id
    ON public.suppliers(tenant_id);


ALTER TABLE IF EXISTS public.tax_masters
    ADD CONSTRAINT tax_masters_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tds_sections
    ADD CONSTRAINT tds_sections_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tenant_module_mapping
    ADD CONSTRAINT tenant_module_mapping_module_id_fkey FOREIGN KEY (module_id)
    REFERENCES public.module_master (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tenant_module_mapping
    ADD CONSTRAINT tenant_module_mapping_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tenant_settings
    ADD CONSTRAINT tenant_settings_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;
CREATE INDEX IF NOT EXISTS idx_tenant_settings_tenant_id
    ON public.tenant_settings(tenant_id);


ALTER TABLE IF EXISTS public.test_categories
    ADD CONSTRAINT test_categories_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_order_items
    ADD CONSTRAINT test_order_items_panel_id_fkey FOREIGN KEY (panel_id)
    REFERENCES public.test_panels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_order_items
    ADD CONSTRAINT test_order_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_order_items
    ADD CONSTRAINT test_order_items_test_id_fkey FOREIGN KEY (test_id)
    REFERENCES public.tests (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_order_items
    ADD CONSTRAINT test_order_items_test_order_id_fkey FOREIGN KEY (test_order_id)
    REFERENCES public.test_orders (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_orders
    ADD CONSTRAINT test_orders_agency_id_fkey FOREIGN KEY (agency_id)
    REFERENCES public.agencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_orders
    ADD CONSTRAINT test_orders_appointment_id_fkey FOREIGN KEY (appointment_id)
    REFERENCES public.appointments (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_orders
    ADD CONSTRAINT test_orders_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_panel_items
    ADD CONSTRAINT test_panel_items_panel_id_fkey FOREIGN KEY (panel_id)
    REFERENCES public.test_panels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_panel_items
    ADD CONSTRAINT test_panel_items_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_panel_items
    ADD CONSTRAINT test_panel_items_test_id_fkey FOREIGN KEY (test_id)
    REFERENCES public.tests (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_panels
    ADD CONSTRAINT test_panels_category_id_fkey FOREIGN KEY (category_id)
    REFERENCES public.test_categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_panels
    ADD CONSTRAINT test_panels_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_parameters
    ADD CONSTRAINT test_parameters_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_parameters
    ADD CONSTRAINT test_parameters_test_id_fkey FOREIGN KEY (test_id)
    REFERENCES public.tests (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_result_details
    ADD CONSTRAINT test_result_details_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_result_details
    ADD CONSTRAINT test_result_details_test_result_id_fkey FOREIGN KEY (test_result_id)
    REFERENCES public.test_results (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_result_files
    ADD CONSTRAINT test_result_files_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_result_files
    ADD CONSTRAINT test_result_files_test_result_id_fkey FOREIGN KEY (test_result_id)
    REFERENCES public.test_results (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_results
    ADD CONSTRAINT test_results_doctor_id_fkey FOREIGN KEY (doctor_id)
    REFERENCES public.doctors (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_results
    ADD CONSTRAINT test_results_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.test_results
    ADD CONSTRAINT test_results_test_order_id_fkey FOREIGN KEY (test_order_id)
    REFERENCES public.test_orders (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tests
    ADD CONSTRAINT tests_category_id_fkey FOREIGN KEY (category_id)
    REFERENCES public.test_categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.tests
    ADD CONSTRAINT tests_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.transaction_template_rules
    ADD CONSTRAINT transaction_template_rules_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.account_masters (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.transaction_template_rules
    ADD CONSTRAINT transaction_template_rules_template_id_fkey FOREIGN KEY (template_id)
    REFERENCES public.transaction_templates (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.transaction_template_rules
    ADD CONSTRAINT transaction_template_rules_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.transaction_templates
    ADD CONSTRAINT transaction_templates_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.transactions
    ADD CONSTRAINT transactions_account_id_fkey FOREIGN KEY (account_id)
    REFERENCES public.accounts (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.transactions
    ADD CONSTRAINT transactions_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.units
    ADD CONSTRAINT units_parent_id_fkey FOREIGN KEY (parent_id)
    REFERENCES public.units (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.units
    ADD CONSTRAINT units_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.user_roles
    ADD CONSTRAINT user_roles_assigned_by_fkey FOREIGN KEY (assigned_by)
    REFERENCES public.users (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.user_roles
    ADD CONSTRAINT user_roles_role_id_fkey FOREIGN KEY (role_id)
    REFERENCES public.roles (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_user_roles_role_id
    ON public.user_roles(role_id);


ALTER TABLE IF EXISTS public.user_roles
    ADD CONSTRAINT user_roles_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.user_roles
    ADD CONSTRAINT user_roles_user_id_fkey FOREIGN KEY (user_id)
    REFERENCES public.users (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_user_roles_user_id
    ON public.user_roles(user_id);


ALTER TABLE IF EXISTS public.users
    ADD CONSTRAINT users_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_users_tenant_id
    ON public.users(tenant_id);


ALTER TABLE IF EXISTS public.voucher_types
    ADD CONSTRAINT voucher_types_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.vouchers
    ADD CONSTRAINT vouchers_currency_id_fkey FOREIGN KEY (currency_id)
    REFERENCES public.currencies (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.vouchers
    ADD CONSTRAINT vouchers_reversal_voucher_id_fkey FOREIGN KEY (reversal_voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.vouchers
    ADD CONSTRAINT vouchers_reversed_voucher_id_fkey FOREIGN KEY (reversed_voucher_id)
    REFERENCES public.vouchers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.vouchers
    ADD CONSTRAINT vouchers_tenant_id_fkey FOREIGN KEY (tenant_id)
    REFERENCES public.tenants (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS idx_vouchers_tenant
    ON public.vouchers(tenant_id);


ALTER TABLE IF EXISTS public.vouchers
    ADD CONSTRAINT vouchers_voucher_type_id_fkey FOREIGN KEY (voucher_type_id)
    REFERENCES public.voucher_types (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;